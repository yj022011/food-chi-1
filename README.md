# Food  <img src="https://latex.codecogs.com/gif.latex?\chi">
This is a group project for CS229, categorized in Natural Language Process.

More details would be in this [poster](https://drive.google.com/open?id=1J7tbJdQwfu4JX3Rdc_TM-nX2g2fifUBA).

## Motivation

As applications and websites develop the trend to provide customized service for users, building recommendation systems has gain more popularity and attention from businesses to improve user experience. While a great number of recommendation systems for movies, audios, books, or restaurants exist, surprisingly there is hardly any for dishes. As food lovers, we intend to address this issue by exploring models for recommending Chinese dishes. 

We scrape data from a popular Chinese recipe website/app called Xia Chu Fang Cooking Recipe\footnote{https://www.xiachufang.com/.}, and implement word embedding algorithms and recommendation system algorithms to build our model. The original input to our algorithms are user IDs from Xia Chu Fang and dish names users have saved in their favourite list. We first preprocess our data and use word2vec on them. We then generate ratings and apply collaborative filtering to build our recommendation system. Specifically, we explore the skip-gram model in word2vec to calculate dish similarity, as well as apply the Non-Negative Matrix Factorization and Singular Value Decomposition methods in collaborative filtering to predict ratings on dishes. Limiting our dishes to Chinese cuisine allows us to focus on constructing a more tailored recommendation system, while still maintain a high practical value given the popularity and diversity of Chinese cuisines. We hope by doing this project, we can tackle a less touched topic of using Machine Learning for dish recommendation, and at the same time promote the greatness of Chinese food.

## Method

### 1. Data crawling

```chef_spider.py```
- Utilize parallel crawling and proxies to fetch data more efficiently
- We run this spider on Google Cloud, which created two virtual machines and each contains 8vCPUs.

### 2. Dish name mapping to fixed dictionary

```preprocess.py```
- Map users' favorite recipes into a fixed-length dictionary, which has 1871 unique keys representing recipe names.
- This dictionary also has corresponding english translation of each dish's chinese recipe name.

### 3. Train models

#### Word2Vec
This content-based method could tackle the issue of a cold start, and intuitively gives us recommendations based on
- your input keywords   
- other users appetites in our database

```word2vec.py```

Usage
1. Suppose you have downloaded our repo including the models in the `models` directory.
2. Then you just need to execute this script by typing `python word2vec.py`

This is our sample output:
![word2vec](res/word2vec_output.png)


Tips
- You may need to install some dependencies by running `pip install -r requirements.txt`.
- If you really don't want to see any warnings, you can simply use this command `python -W ignore word2vec.py`.
- The visualization by t-SNE is in the `res` folder, you can see the two figures ([here](res/word_tsne_full_1.html) and [here](res/word_tsne_full_2.html)) which generated by different seeds.

    Also, we have a [sample](res/word_tsne_small.html) only trained by partial data.   

#### Collaborative filtering

+ NMF (Non-negative Matrix Factorization)
+ SVD (Singular Value Decomposition)

We implement this idea mainly by using **matrix factorization**, which gives us a more quantified way to measure our model performance by RMSE and recall. See more details [here](collab_filter_analysis.ipynb).

TL;DR;

|     | Dev Set RMSE | Test Set RMSE | Dev Set Recall | Test Set Recall |
|-----|--------------|---------------|----------------|-----------------|
| NMF | 0.4574       | 0.5851        | 0.5081         | 0.5393          |
| SVD | 0.3317       | 0.3634        | 0.9173         | 0.9301          |

